<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculator</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; background: #f0f2f5; }
  .card { background: #fff; padding: 2rem; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.1); width: 320px; }
  h1 { font-size: 1.4rem; margin-bottom: 1.5rem; text-align: center; color: #1a1a2e; }
  label { display: block; font-size: 0.85rem; color: #555; margin-bottom: 0.3rem; }
  input, select { width: 100%; padding: 0.6rem 0.8rem; border: 1px solid #ddd; border-radius: 6px; font-size: 1rem; margin-bottom: 1rem; transition: border-color 0.2s; }
  input:focus, select:focus { outline: none; border-color: #4361ee; }
  input.error { border-color: #e63946; }
  button { width: 100%; padding: 0.7rem; background: #4361ee; color: #fff; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; transition: background 0.2s; }
  button:hover { background: #3a56d4; }
  .result { margin-top: 1.2rem; text-align: center; font-size: 1.3rem; color: #1a1a2e; min-height: 1.6em; }
  .error-msg { color: #e63946; font-size: 0.85rem; text-align: center; margin-top: 0.5rem; min-height: 1.2em; }
  #fireworksCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; display: none; }
</style>
</head>
<body>
<canvas id="fireworksCanvas"></canvas>
<div class="card">
  <h1>Calculator</h1>
  <label for="num1">First Number</label>
  <input type="text" id="num1" placeholder="Enter a number" autocomplete="off">
  <label for="op">Operation</label>
  <select id="op">
    <option value="+" selected>+ Add</option>
    <option value="-">− Subtract</option>
    <option value="*">× Multiply</option>
    <option value="/">÷ Divide</option>
  </select>
  <label for="num2">Second Number</label>
  <input type="text" id="num2" placeholder="Enter a number" autocomplete="off">
  <button id="calcBtn">Calculate</button>
  <div class="error-msg" id="errorMsg"></div>
  <div class="result" id="result"></div>
</div>
<script>
  const num1 = document.getElementById('num1');
  const num2 = document.getElementById('num2');
  const op = document.getElementById('op');
  const btn = document.getElementById('calcBtn');
  const result = document.getElementById('result');
  const errorMsg = document.getElementById('errorMsg');

  function clearState() {
    num1.classList.remove('error');
    num2.classList.remove('error');
    errorMsg.textContent = '';
    result.textContent = '';
  }

  function validate(input) {
    const val = input.value.trim();
    if (val === '' || isNaN(val)) {
      input.classList.add('error');
      return null;
    }
    return parseFloat(val);
  }

  btn.addEventListener('click', function() {
    clearState();
    const a = validate(num1);
    const b = validate(num2);
    if (a === null || b === null) {
      errorMsg.textContent = 'Please enter valid numbers in both fields.';
      return;
    }
    const operator = op.value;
    if (operator === '/' && b === 0) {
      errorMsg.textContent = 'Cannot divide by zero.';
      return;
    }
    let res;
    switch (operator) {
      case '+': res = a + b; break;
      case '-': res = a - b; break;
      case '*': res = a * b; break;
      case '/': res = a / b; break;
    }
    result.textContent = res;
    launchFireworks();
  });

  [num1, num2, op].forEach(el => el.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') btn.click();
  }));

  // Fireworks animation
  const canvas = document.getElementById('fireworksCanvas');
  const ctx = canvas.getContext('2d');
  let particles = [];
  let rockets = [];
  let animationId = null;
  let animationTimeout = null;

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }

  window.addEventListener('resize', resizeCanvas);

  function randomRange(min, max) {
    return Math.random() * (max - min) + min;
  }

  function randomColor() {
    const colors = ['#ff6b6b','#feca57','#48dbfb','#ff9ff3','#54a0ff','#5f27cd','#01a3a4','#f368e0','#ff9f43','#00d2d3'];
    return colors[Math.floor(Math.random() * colors.length)];
  }

  function createRocket(x) {
    return {
      x: x,
      y: canvas.height,
      targetY: randomRange(canvas.height * 0.1, canvas.height * 0.4),
      speed: randomRange(8, 12),
      color: '#fff',
      alive: true
    };
  }

  function explodeRocket(rocket) {
    const count = Math.floor(randomRange(30, 50));
    for (let i = 0; i < count; i++) {
      const angle = Math.random() * Math.PI * 2;
      const speed = randomRange(1, 6);
      particles.push({
        x: rocket.x,
        y: rocket.y,
        vx: Math.cos(angle) * speed,
        vy: Math.sin(angle) * speed,
        color: randomColor(),
        alpha: 1,
        fade: randomRange(0.008, 0.025),
        gravity: 0.05,
        size: randomRange(1.5, 3.5)
      });
    }
  }

  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Update and draw rockets
    for (let i = rockets.length - 1; i >= 0; i--) {
      const r = rockets[i];
      if (!r.alive) continue;
      r.y -= r.speed;
      if (r.y <= r.targetY) {
        r.alive = false;
        explodeRocket(r);
      } else {
        ctx.beginPath();
        ctx.arc(r.x, r.y, 2, 0, Math.PI * 2);
        ctx.fillStyle = r.color;
        ctx.fill();
      }
    }

    // Update and draw particles
    for (let i = particles.length - 1; i >= 0; i--) {
      const p = particles[i];
      p.x += p.vx;
      p.vy += p.gravity;
      p.y += p.vy;
      p.alpha -= p.fade;
      if (p.alpha <= 0) {
        particles.splice(i, 1);
        continue;
      }
      ctx.globalAlpha = p.alpha;
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fillStyle = p.color;
      ctx.fill();
    }
    ctx.globalAlpha = 1;

    // Continue if there's anything left to draw
    if (particles.length > 0 || rockets.some(r => r.alive)) {
      animationId = requestAnimationFrame(animate);
    } else {
      stopFireworks();
    }
  }

  function stopFireworks() {
    if (animationId) {
      cancelAnimationFrame(animationId);
      animationId = null;
    }
    if (animationTimeout) {
      clearTimeout(animationTimeout);
      animationTimeout = null;
    }
    particles = [];
    rockets = [];
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    canvas.style.display = 'none';
  }

  function launchFireworks() {
    stopFireworks();
    resizeCanvas();
    canvas.style.display = 'block';

    const rocketCount = Math.floor(randomRange(3, 6));
    for (let i = 0; i < rocketCount; i++) {
      setTimeout(function() {
        rockets.push(createRocket(randomRange(canvas.width * 0.15, canvas.width * 0.85)));
      }, i * randomRange(100, 300));
    }

    animationId = requestAnimationFrame(animate);

    // Force-stop after 3 seconds
    animationTimeout = setTimeout(stopFireworks, 3000);
  }
</script>
</body>
</html>
